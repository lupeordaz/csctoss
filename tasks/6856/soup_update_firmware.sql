
select ds.firmware
  from device_stats ds
 where ds.timestamp = (select MAX(timestamp) from device_stats ds2 where ds2.did = ds.did)
   and ds.did in (14858, 14859, 14860, 14861, 14862, 14863, 14864 );


select ds.did
      ,ds.firmware
  from device_stats ds
      ,(select did from device where part_number = '65-123456789' order by 1) as d
 where ds.did = d.did
   and ds.timestamp = (select max(timestamp) from device_stats ds2 where ds2.did = ds.did);




update device_stats
   set firmware = 'Managed'
 where did IN (
444,
446,
447,
448,
449,
450,
451,
452,
453,
454,
455,
456,
457,
458,
459,
460,
461,
463,
464,
465,
466,
467,
468,
469,
471,
472,
473,
474,
475,
476,
477,
479,
480,
481,
482,
483,
484,
485,
486,
487,
488,
489,
490,
491,
493,
494,
495,
496,
497,
498,
499,
500,
501,
502,
503,
504,
505,
506,
508,
509,
510,
511,
512,
513,
514,
515,
516,
517,
518,
519,
520,
521,
522,
523,
524,
525,
526,
527,
528,
529,
531,
532,
534,
535,
536,
538,
13452,
13526,
13574,
13575,
13576,
13577,
13578,
13579,
13580,
13581,
13582,
13583,
13585,
13586,
13587,
13588,
13589,
13590,
13591,
13592,
13593,
13595,
13598,
13652,
13761,
13765,
13768,
13857,
13908,
13957,
14102,
14106,
14115,
14153,
14159,
14160,
14161,
14162,
14163,
14164,
14165,
14170,
14171,
14179,
14361,
14396,
14405,
14406,
14439,
14514,
14719,
14801,
14802,
14803,
14804,
14805,
14807,
14808,
14809,
14810,
14811,
14812,
14813,
14814,
14815,
14817,
14818,
14819,
14820,
14821,
14823,
14824,
14825,
14826,
14827,
14828,
14829,
14830,
14831,
14832,
14833,
14834,
14835,
14836,
14837,
14838,
14839,
14840,
14841,
14842,
14843,
14844,
14845,
14846,
14847,
14848,
14849,
14850,
14851,
14852,
14854,
14855,
14856,
14857,
14858,
14859,
14860,
14861,
14862,
14863,
14864,
14865,
14866,
14867,
14868,
14869,
14870,
14871,
14872,
14873,
14874,
14875,
14876,
14877,
14878,
14879,
14880,
14881,
14882,
14883,
14915,
14960);
